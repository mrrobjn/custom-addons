<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <record id="schedule_view_calendar" model="ir.ui.view">
        <field name="name">meeting.schedule.calendar</field>
        <field name="model">meeting.schedule</field>
        <field name="arch" type="xml">
            <calendar
                string="Booking Schedule"
                date_start="start_date"
                date_stop="end_date"
                mode="week"
                color="room_id"
                date_delay="duration"
                quick_add="false"
                event_open_popup="true"
            >
                <field name="meeting_subject" />
                <field name="start_date" />
                <field name="end_date" />
                <field name="user_id" filters="1" avatar_field="avatar_128" />
                <field name="room_id" filters="1" />
            </calendar>
        </field>
    </record>

    <record id="schedule_view_kanban" model="ir.ui.view">
        <field name="name">schedule.view.kanban</field>
        <field name="model">meeting.schedule</field>
        <field name="arch" type="xml">
            <kanban group_create="false" quick_create="false" group_edit="false"
                group_delete="false">
                <templates>
                    <t t-name="kanban-box">
                        <div
                            class="o_kanban_content oe_kanban_global_click p-0 m-0 mx-2 mb-2 position-relative row d-flex flex-fill">
                            <div
                                class="col-3 bg-primary px-2 py-4 text-center d-flex flex-column justify-content-center">
                                <div class="o_event_fontsize_20">
                                    <h2>
                                        <field name="day" />
                                    </h2>
                                </div>
                                <div>
                                    <field name="month" />
                                </div>
                                <div>
                                    <field name="time" />
                                </div>
                            </div>
                            <div
                                class="col-9 py-2 px-3 d-flex flex-column justify-content-between pt-3">
                                <div>
                                    <div class="o_kanban_record_title o_text_overflow">
                                        <span>
                                            <field name="meeting_subject" />
                                        </span>
                                    </div>
                                    <div>
                                        <i class="fa fa-map-marker" />
                                        <span class="o_text_overflow o_event_kanban_location">
                                            <field name="room_id" />
                                        </span>
                                    </div>
                                </div>
                                <div style="display: flex;">
                                    <img
                                        t-att-src="kanban_image('res.users', 'avatar_128', record.user_id.raw_value)"
                                        class="oe_kanban_image resized-image"
                                        alt="avatar"
                                    />
                                    <span style="height: 100%; display: flex; align-item: center;">
                                        <field name="user_id" />
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="schedule_view_tree" model="ir.ui.view">
        <field name="name">meeting.tree</field>
        <field name="model">meeting.schedule</field>
        <field name="arch" type="xml">
            <tree string="Schedules">
                <field name="meeting_subject" />
                <field name="name" />
                <field name="start_date" />
                <field name="end_date" />
                <field name="duration" />
                <field name="user_id" widget="many2one_avatar_user" />
                <field name="company_id" optional="show" />
            </tree>
        </field>
    </record>

    <record id="meeting_view_form" model="ir.ui.view">
        <field name="name">meeting.schedule.form</field>
        <field name="model">meeting.schedule</field>
        <field name="arch" type="xml">
            <form string="New Meeting">
                <sheet>
                    <group attrs="{'invisible':[('is_edit', '=', True)]}">
                        <group>
                            <field name="action" />
                        </group>
                    </group>
                    <group attrs="{'invisible': [('action', '=', 'delete')]}">
                        <field name="meeting_subject"
                            attrs="{'required':[('action','=','create')],'readonly': [('check_access_team_id', '=', False)]}" />
                        <field name="check_access_team_id" invisible="1" />
                    </group>
                    <group attrs="{'invisible': [('action', '=', 'delete')]}">
                        <group>
                            <field name="room_id"
                                attrs="{'required':[('action','=','create')],'readonly': [('check_access_team_id', '=', False)]}"></field>
                        </group>
                        <group>
                            <field name="meeting_type"
                                attrs="{'invisible':[('is_edit', '=', True)]}" />
                            <field name="user_id" attrs="{'invisible':[('is_edit', '=', False)]}"
                                readonly="1"></field>
                        </group>
                    </group>
                    <group>
                        <group>
                            <field name="start_date"
                                attrs="{'readonly': [('check_access_team_id', '=', False)]}" />
                            <field name="end_date"
                                attrs="{'readonly': [('check_access_team_id', '=', False)]}" />
                        </group>
                        <group attrs="{'invisible': [('action', '=', 'delete')]}">
                            <field name="duration" invisible="1"></field>
                            <field name="duration_minutes"></field>
                            <field name="repeat_weekly"
                                attrs="{'invisible': ['|',('meeting_type', '!=', 'weekly'),('is_edit', '=', True)]}"></field>
                        </group>
                        <group attrs="{'invisible': [('action', '!=', 'delete')]}">
                            <field name="include_other"
                                groups="meeting_room.group_meeting_room_hr"
                                widget="boolean_toggle" />
                            <field name="is_edit" invisible="1" />
                        </group>
                    </group>
                    <group
                        attrs="{'invisible': ['|',('action', '=', 'delete'),('is_edit', '=', True)]}">
                        <group attrs="{'invisible': [('meeting_type', '=', 'normal')]}">
                            <field name="monday" />
                            <field name="tuesday" />
                            <field name="wednesday" />
                            <field name="thursday" />
                        </group>
                        <group attrs="{'invisible': [('meeting_type', '=', 'normal')]}">
                            <field name="friday" />
                            <field name="saturday" />
                            <field name="sunday" />
                        </group>
                    </group>
                    <!-- attachment -->
                    <group
                        attrs="{'invisible': ['|',('action', '=', 'delete'),('is_partner', '=', False)]}">
                        <field name="is_partner" invisible="1" />
                        <field name="attachment" filename="filename" mimetype="mimetype"
                            widget="preview_binary"
                            attrs="{'readonly': [('check_access_team_id', '=', False)]}"
                        />
                        <field name="filename" invisible="1" />
                    </group>
                    <!-- attachment -->
                    <group attrs="{'invisible': [('action', '=', 'delete')]}">
                        <field name="description"
                            attrs="{'readonly': [('check_access_team_id', '=', False)]}"></field>
                    </group>
                    <notebook attrs="{'invisible': [('action', '=', 'delete')]}">
                        <page string="Attendees">
                            <field name="partner_ids"
                                attrs="{'readonly': [('check_access_team_id', '=', False)]}" />
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="schedule_view_search" model="ir.ui.view">
        <field name="name">schedule.patient.search</field>
        <field name="model">meeting.schedule</field>
        <field name="arch" type="xml">
            <search string="">
                <field name="name"
                    filter_domain="['|', ('meeting_subject', 'ilike', self), ('user_id.name', 'ilike', self)]"></field>
                <group string="Group By">
                    <filter string="Room" name="group_by_room" context="{'group_by': 'room_id'}" />
                </group>
            </search>
        </field>
    </record>

    <record id="email_template_name" model="mail.template">
        <field name="name">EMAIL TEMPLATE NAME</field>
        <field name="model_id" ref="meeting_room.model_meeting_schedule" />
        <field name="auto_delete" eval="True" />
        <field name="email_from">{{object.create_uid.email_formatted or ''}}</field>
        <field name="email_to">{{', '.join(object.partner_ids.mapped('email')) or ''}}</field>
        <field name="body_html" type="html">
            <p>Dear Sir/Madam,</p>
            <p>I hope this message finds you well. We are excited to invite you to our upcoming Zoom
                meeting, where we will discuss important matters and collaborate on upcoming
                projects.
                Below are the details for the meeting:
            </p>
            <p> Datetime: <span t-field="object.start_date" />
            </p>
            <p> Agenda: <span t-field="object.description" />

            </p>
            <p> Your active participation and input are highly valued as we strive to move forward
                as a cohesive team. Please make sure to mark your calendars accordingly and join the
                meeting promptly at the scheduled time.

            </p>
            <p>If you have any questions or specific topics you would like to address during the
                meeting, please feel free to reach out to me beforehand.

            </p>
            <p>Looking forward to seeing you all there!
            </p>
            <p>
                Best regards,
            </p>
        </field>
    </record>

    <record id="action_meeting_schedule" model="ir.actions.act_window">
        <field name="name">Meeting Schedule</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">meeting.schedule</field>
        <field name="view_mode">calendar,kanban,tree,form</field>
        <field name="context">{'search_default_group_by_room':1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Nothing here
            </p>
        </field>
    </record>

</odoo>